Search.setIndex({"docnames": ["guide", "index", "parallel_training", "pytorch_lightning", "quick-reference", "torch_ddp"], "filenames": ["guide.rst", "index.rst", "parallel_training.rst", "pytorch_lightning.rst", "quick-reference.rst", "torch_ddp.rst"], "titles": ["Instructor\u2019s guide", "Parallelizing pytorch models", "Parallel Training Backround", "&lt;no title&gt;", "Quick Reference", "Training a Neural Network in parallel using DistributedDataParallel"], "terms": {"There": [1, 5], "ar": [1, 2, 5], "multipl": [1, 2, 5], "wai": [1, 2], "util": [1, 2], "process": [1, 2, 5], "power": 1, "In": [1, 2], "thi": [1, 2, 5], "workshop": [1, 2, 5], "we": [1, 2, 5], "ll": [1, 5], "look": [1, 5], "common": 1, "do": [1, 5], "go": [1, 5], "through": [1, 5], "": [1, 2, 5], "built": 1, "distributeddataparallel": [1, 2], "framework": 1, "how": [1, 5], "can": [1, 2, 5], "adapt": 1, "an": 1, "exist": 1, "too": 1, "familiar": 1, "experi": [1, 2], "implement": [1, 5], "neural": 1, "network": [1, 2], "i": [1, 2, 5], "assum": 1, "train": 1, "backround": 1, "us": [1, 2], "The": [1, 2], "lesson": 1, "file": [1, 5], "structur": 1, "brows": 1, "layout": 1, "inspir": 1, "deriv": 1, "from": [1, 5], "work": [1, 5], "coderefineri": 1, "licens": 1, "under": 1, "mit": 1, "have": [1, 2, 5], "copi": [1, 5], "most": [1, 2, 5], "text": 1, "made": 1, "avail": [1, 5], "creativ": 1, "attribut": 1, "cc": 1, "BY": 1, "4": 1, "0": [1, 5], "follow": 1, "human": 1, "readabl": 1, "summari": 1, "substitut": 1, "full": 1, "legal": 1, "you": [1, 5], "free": 1, "share": 1, "redistribut": 1, "ani": 1, "medium": 1, "format": 1, "remix": 1, "transform": 1, "build": 1, "upon": 1, "purpos": 1, "even": 1, "commerci": 1, "licensor": 1, "cannot": 1, "revok": 1, "freedom": 1, "long": [1, 2], "term": 1, "must": 1, "give": [1, 2, 5], "appropri": [1, 5], "mention": 1, "your": [1, 5], "copyright": 1, "c": 1, "individu": 1, "contributor": 1, "where": [1, 5], "practic": 1, "link": 1, "http": 1, "encc": 1, "se": 1, "provid": 1, "indic": [1, 5], "chang": 1, "were": 1, "mai": [1, 5], "so": [1, 5], "reason": [1, 5], "manner": 1, "suggest": 1, "endors": 1, "No": 1, "addit": 1, "restrict": 1, "appli": 1, "technolog": 1, "measur": 1, "other": 1, "anyth": 1, "permit": 1, "With": [1, 2], "understand": 1, "compli": 1, "element": 1, "public": 1, "domain": 1, "applic": 1, "except": 1, "limit": [1, 5], "warranti": 1, "given": 1, "all": [1, 5], "permiss": 1, "necessari": 1, "intend": 1, "For": 1, "exampl": [1, 2, 5], "right": [1, 5], "privaci": 1, "moral": 1, "otherwis": 1, "note": [1, 5], "program": [1, 5], "repositori": 1, "osi": 1, "approv": 1, "increas": 2, "amount": 2, "comput": [2, 5], "form": 2, "cluster": 2, "need": [2, 5], "model": [2, 5], "when": [2, 5], "pytorch": [2, 5], "essenti": 2, "three": [2, 5], "engin": 2, "complex": 2, "perform": [2, 5], "cross": 2, "valid": 2, "hyper": 2, "paramet": [2, 5], "optim": 2, "each": 2, "run": 2, "while": 2, "effici": 2, "hp": 2, "requir": 2, "commun": [2, 5], "between": [2, 5], "job": 2, "outsid": 2, "respons": 2, "over": [2, 5], "batch": [2, 5], "data": 2, "spread": 2, "gpu": [2, 5], "node": [2, 5], "worker": [2, 5], "synchron": [2, 5], "dure": 2, "maintain": 2, "same": [2, 5], "modul": 2, "differ": [2, 5], "layer": 2, "split": [2, 5], "both": 2, "forward": 2, "backward": [2, 5], "propag": 2, "well": 2, "focu": [2, 5], "case": [2, 5], "fundament": 2, "challang": 2, "make": [2, 5], "coordin": [2, 5], "pythorch": 2, "distribut": 2, "runtim": 2, "take": [2, 5], "care": 2, "hassl": 2, "u": [2, 5], "spawn": [2, 5], "thei": 2, "conveni": [2, 5], "method": 2, "set": [2, 5], "them": [2, 5], "up": [2, 5], "group": [2, 5], "simpl": 5, "recurr": 5, "sequenc": 5, "classif": 5, "featur": 5, "find": 5, "here": 5, "reli": 5, "anaconda": 5, "creat": 5, "environ": 5, "conda": 5, "env": 5, "f": 5, "yml": 5, "onc": 5, "done": 5, "activ": 5, "envioron": 5, "partorch": 5, "now": 5, "archiv": 5, "after": 5, "extract": 5, "directori": 5, "pip": 5, "e": 5, "packag": 5, "global": 5, "mainli": 5, "script": 5, "basic_neural_network": 5, "py": 5, "import": 5, "part": 5, "replic": 5, "below": 5, "visible_index": 5, "heldout_indic": 5, "train_test_split": 5, "np": 5, "arang": 5, "len": 5, "smiles_list": 5, "stratifi": 5, "label": 5, "shuffl": 5, "true": 5, "test_siz": 5, "1": 5, "random_st": 5, "arg": 5, "random_se": 5, "visible_label": 5, "train_indic": 5, "dev_indic": 5, "2": 5, "train_dataload": 5, "get_dataload": 5, "token": 5, "batch_siz": 5, "num_work": 5, "dev_dataload": 5, "model_kwarg": 5, "dict": 5, "devic": 5, "model_hparam": 5, "embedding_dim": 5, "128": 5, "d_model": 5, "num_lay": 5, "3": 5, "bidirect": 5, "dropout": 5, "learning_r": 5, "001": 5, "weight_decai": 5, "0001": 5, "tb_writer": 5, "summarywrit": 5, "basic_run": 5, "best_model": 5, "best_iter": 5, "writer": 5, "max_epoch": 5, "model_class": 5, "rnnpredictor": 5, "model_arg": 5, "tupl": 5, "heldout_dataload": 5, "heldout_loss": 5, "heldout_target": 5, "heldout_predict": 5, "loss": 5, "batch_target": 5, "batch_predict": 5, "eval_and_predict_batch": 5, "append": 5, "extend": 5, "heldout_roc_auc": 5, "roc_auc_scor": 5, "add_scalar": 5, "test": 5, "mean": 5, "roc_auc": 5, "add_hparam": 5, "hparam_dict": 5, "metric_dict": 5, "hparam": 5, "print": 5, "final": 5, "roc": 5, "auc": 5, "close": 5, "highlight": 5, "line": 5, "show": 5, "These": 5, "ones": 5, "which": 5, "account": 5, "ad": 5, "our": 5, "consist": 5, "concurr": 5, "main": 5, "execut": 5, "To": 5, "differenti": 5, "identifi": 5, "call": 5, "rank": 5, "often": 5, "wan": 5, "t": 5, "some": 5, "step": 5, "onli": 5, "whole": 5, "customari": 5, "assign": 5, "one": 5, "special": 5, "typic": 5, "chosen": 5, "start": 5, "function": 5, "want": 5, "wrap": 5, "distributed_train": 5, "entri": 5, "point": 5, "multiprocess": 5, "target": 5, "also": 5, "dictionari": 5, "argument": 5, "suppli": 5, "torch": 5, "total": 5, "size": 5, "world_siz": 5, "cuda": 5, "device_count": 5, "distributed_kwarg": 5, "backend": 5, "nccl": 5, "mp": 5, "join": 5, "nproc": 5, "defin": 5, "someth": 5, "like": 5, "def": 5, "kwarg": 5, "dist": 5, "init_process_group": 5, "just": 5, "unpack": 5, "gave": 5, "vital": 5, "what": 5, "actual": 5, "current": 5, "lot": 5, "machineri": 5, "beneath": 5, "cover": 5, "One": 5, "question": 5, "should": 5, "specifi": 5, "interprocess": 5, "recommend": 5, "develop": 5, "nvidia": 5, "A": 5, "instanti": 5, "refer": 5, "If": 5, "subset": 5, "environment": 5, "variabl": 5, "cuda_visible_gpu": 5, "id1": 5, "id2": 5, "befor": 5, "simplifi": 5, "underli": 5, "torchrun": 5, "inform": 5, "master": 5, "locat": 5, "master_port": 5, "31133": 5, "basic_neural_network_ddp": 5, "dataset": 5, "bbbp": 5, "csv": 5, "allow": 5, "particular": 5, "tell": 5, "specif": 5, "port": 5, "arbitrari": 5, "might": 5, "valu": 5, "re": 5, "time": 5, "manual": 5, "ip": 5, "adress": 5, "supplii": 5, "master_addr": 5, "readi": 5, "more": 5, "goal": 5, "let": 5, "partit": 5, "base": 5, "outlin": 5, "next": 5, "get_ddp_dataload": 5, "none": 5, "don": 5, "pass": 5, "predict": 5, "around": 5, "filename_suffix": 5, "train_ddp": 5, "test_dataload": 5, "loss_fn": 5, "nn": 5, "bcewithlogitsloss": 5, "no_grad": 5, "sequence_batch": 5, "length": 5, "logit_predict": 5, "squeez": 5, "prob_predict": 5, "sigmoid": 5, "item": 5, "cpu": 5, "numpi": 5, "block": 5, "order": 5, "first": 5, "fals": 5, "smiles_dataset": 5, "smilesdataset": 5, "dataload": 5, "collate_fn": 5, "collate_funct": 5, "drop_last": 5, "return": 5, "sampler": 5, "distributedsampl": 5, "num_replica": 5, "alreadi": 5, "ha": 5, "By": 5, "world": 5, "get": 5, "its": 5, "own": 5, "dedic": 5, "ve": 5, "regist": 5, "old": 5, "v": 5, "updat": 5, "loop": 5, "best_roc_auc": 5, "iter": 5, "adamw": 5, "lr": 5, "trang": 5, "desc": 5, "epoch": 5, "training_loss": 5, "dev_loss": 5, "dev_target": 5, "dev_predict": 5, "tqdm": 5, "zero_grad": 5, "eval": 5, "dev": 5, "dev_roc_auc": 5, "tdev": 5, "deepcopi": 5, "recurrent_lay": 5, "flatten_paramet": 5, "weight": 5, "matric": 5, "necessarili": 5, "contigu": 5, "memori": 5, "fix": 5, "issu": 5, "ddp_model": 5, "rang": 5, "get_rank": 5, "compar": 5, "two": 5, "see": 5, "basic": 5, "object": 5, "new": 5, "subsequ": 5, "replac": 5, "thing": 5, "gradient": 5, "across": 5, "send": 5, "result": 5, "complet": 5, "augment": 5}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"instructor": 0, "": 0, "guid": 0, "parallel": [1, 2, 5], "pytorch": 1, "model": 1, "prerequisit": 1, "background": 1, "credit": 1, "instruct": 1, "materi": 1, "softwar": 1, "train": [2, 5], "backround": 2, "quick": 4, "refer": 4, "neural": 5, "network": 5, "us": 5, "distributeddataparallel": 5, "instal": 5, "modifi": 5, "an": 5, "exist": 5, "semant": 5, "initi": 5, "distribut": 5, "framework": 5, "The": 5, "data": 5, "loader": 5, "optim": 5, "central": 5, "evalu": 5, "run": 5, "code": 5}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.todo": 2, "sphinx": 57}, "alltitles": {"Instructor\u2019s guide": [[0, "instructor-s-guide"]], "Parallelizing pytorch models": [[1, "parallelizing-pytorch-models"]], "Prerequisites": [[1, "prerequisites-0"]], "Background": [[1, null]], "Credits": [[1, "credits"]], "Instructional Material": [[1, "instructional-material"]], "Software": [[1, "software"]], "Parallel Training Backround": [[2, "parallel-training-backround"]], "Quick Reference": [[4, "quick-reference"]], "Training a Neural Network in parallel using DistributedDataParallel": [[5, "training-a-neural-network-in-parallel-using-distributeddataparallel"]], "Installation": [[5, "installation"]], "Modifying an existing network": [[5, "modifying-an-existing-network"]], "Parallel semantics": [[5, "parallel-semantics"]], "Initializing the distributed framework": [[5, "initializing-the-distributed-framework"]], "The distributed training": [[5, "the-distributed-training"]], "Distributed data loaders": [[5, "distributed-data-loaders"]], "Distributed optimization": [[5, "distributed-optimization"]], "Centralizing evaluation": [[5, "centralizing-evaluation"]], "Running the code": [[5, "running-the-code"]]}, "indexentries": {}})